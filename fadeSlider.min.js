
"use strict";var FadeSlider=function FadeSlider(customSettings){var settings={adaptive:"hybrid",treshholdMax:1180,treshholdMin:586,reductionIndex:1.65,controls:true,pager:false,duration:10000,fadeTime:1800,animation:true,animationChange:"random",colorFilter:false,caption:false,auto:true};[settings,customSettings].reduce(function(r,o){Object.keys(o).forEach(function(k){r[k]=o[k];});return r;});var adaptive=settings.adaptive;var treshholdMax=settings.treshholdMax;var treshholdMin=settings.treshholdMin;var reductionIndex=settings.reductionIndex;var pager=settings.pager;var controls=settings.controls;var duration=settings.duration;var fadeTime=settings.fadeTime;var animation=settings.animation;var animationChange=settings.animationChange;var colorFilter=settings.colorFilter;var caption=settings.caption;var auto=settings.auto;var selectorMatch=void 0,currentSlide=void 0,oldSlide=void 0,sliderAdaptHeight=void 0,aspectRatio=void 0,startState=void 0,oldRand=void 0,newRand=void 0,slidesCount=void 0,$leftControl=void 0,$rightControl=void 0,$pager=void 0,$pagerLi=void 0;var angleZoomArr=['zoom_BL','zoom_TR','zoom_TL','zoom_BR'];var symbolArray=[/#/,/./,/ /];if(Array.isArray(animationChange)){var customChange=[];var standartZoomArr=['zoom_TL','zoom_TR','zoom_BR','zoom_BL'];for(var i=0;i<4;i++){customChange[i]=standartZoomArr[animationChange[i]];}}
var totalImgSize={x:0,y:0};var middleSize={};var timeOut={};var Helper={};Helper.getSelector=function(target){for(var s in symbolArray){selectorMatch=target.match(symbolArray[s]);if(selectorMatch!=null){switch(selectorMatch[0]){case" ":return document.querySelector(target);break;case".":return document.getElementsByClassName(target.slice(1))[0];break;case"#":return document.getElementById(target.slice(1));break;}}}};Helper.sizing=function(totalWidth,totalHeight){middleSize.width=Math.floor(totalWidth/$img.length);middleSize.height=Math.floor(totalHeight/$img.length);aspectRatio=middleSize.height/middleSize.width;Helper.sliderResize();};Helper.sliderResize=function(){var sliderWidth=$slider.clientWidth;var sliderHeight=$slider.clientHeight;if(adaptive=="hybrid"){var screenWidth=document.body.clientWidth;var middleImgHeight=0;if(screenWidth>treshholdMax){for(var _i=0;_i<maxSlides;_i++){$img[_i].style.width=middleSize.width+"px";if(screenWidth<middleSize.width){$img[_i].style.left=(screenWidth-middleSize.width)/2+"px";}else{$img[_i].style.left="0px";}
middleImgHeight+=$img[_i].clientHeight;}
$slider.style.height=middleImgHeight/maxSlides+"px";}else if(screenWidth<treshholdMax&&screenWidth>treshholdMin){var newW=middleSize.width-(treshholdMax-screenWidth)*reductionIndex;for(var _i2=0;_i2<maxSlides;_i2++){$img[_i2].style.width=newW+"px";$img[_i2].style.left=(screenWidth-newW)/2+"px";middleImgHeight+=$img[_i2].clientHeight;}
$slider.style.height=middleImgHeight/maxSlides+"px";}else if(screenWidth<treshholdMax&&screenWidth<treshholdMin){for(var _i3=0;_i3<maxSlides;_i3++){var _newW=middleSize.width-(treshholdMax-treshholdMin)*reductionIndex;$img[_i3].style.width=_newW+"px";$img[_i3].style.left=(screenWidth-_newW)/2+"px";middleImgHeight+=$img[_i3].clientHeight;}
$slider.style.height=middleImgHeight/maxSlides+"px";}}else if(adaptive){sliderAdaptHeight=sliderWidth*aspectRatio;$slider.style.height=sliderAdaptHeight+"px";for(var _i4=0;_i4<maxSlides;_i4++){var imgHeight=$img[_i4].clientHeight;var imgAdaptH=sliderWidth/$img[_i4].clientWidth*imgHeight;if(imgAdaptH<sliderAdaptHeight){var _newW2=sliderAdaptHeight/$img[_i4].naturalHeight*$img[_i4].naturalWidth;$img[_i4].style.width=_newW2+"px";$img[_i4].style.height="100%";var def=parseInt((sliderWidth-_newW2)/2);$img[_i4].style.left=def+"px";}else{$img[_i4].style.width="100%";}}}else{sliderAdaptHeight=parseFloat($slider.style.height);for(var _i5=0;_i5<maxSlides;_i5++){var imgWidth=$img[_i5].clientWidth;var _imgHeight=$img[_i5].clientHeight;if(_imgHeight<sliderHeight){$img[_i5].style.height=sliderHeight+"px";$img[_i5].style.width=imgWidth/_imgHeight*sliderHeight+"px";}
if($img[_i5].clientWidth<sliderWidth){$img[_i5].style.width=sliderWidth+"px";}
if(imgWidth>sliderWidth){var _def=parseInt((sliderWidth-imgWidth)/2);$img[_i5].style.left=_def+"px";}else{$img[_i5].style.left="";}}}};Helper.raf=function(fn){window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){fn();});});};Helper.getMode=function(){if(Array.isArray(animationChange)){return customChange[slidesCount%4];}else if(animationChange=="default"){return angleZoomArr[slidesCount%4];}else if(animationChange=="random"){newRand=parseInt(Math.random()*3);if(newRand!=oldRand){oldRand=newRand;}else{if(newRand==maxSlides-1){newRand--;oldRand=newRand;}else{newRand++;oldRand=newRand;}}
return angleZoomArr[newRand];}};Helper.error=function(message){if($slider)$slider.style.display="none";console.error(message);};if(fadeTime*1.5>duration){Helper.error("Fade Slider : Время перехода не может быть больше времени анимации!");return;}
var $slider=Helper.getSelector(settings.target);if(!$slider){Helper.error("Fade Slider : Контейнер слайдера не был найден!");return;}
var $sliderChild=$slider.children;if($sliderChild.length==0){Helper.error("Fade Slider : Содержимое слайдера не найдено!");return;}
var $viewport=function(){for(var _i6=0,max=$sliderChild.length;_i6<max;_i6++){if($sliderChild[_i6].tagName=="UL"){return $sliderChild[_i6];break;}}}();var $li=$viewport.getElementsByTagName("li");var maxSlides=$li.length;if(maxSlides==0){Helper.error("Fade Slider : Нет ни одного слайда");return;}
$slider.classList.add("fadeSlider");$viewport.classList.add("fs-Viewport");var $frame=[];for(var _i7=0;_i7<maxSlides;_i7++){$frame[_i7]=document.createElement("div");$frame[_i7].classList.add("fs-Frame");$frame[_i7].style.transitionDuration=fadeTime+"ms";if(animation){$frame[_i7].classList.add("fs-zoom");$frame[_i7].style.animationDuration=duration+fadeTime+"ms";}else{$frame[_i7].classList.add("fs-pulse");}}
if(caption){var $caption=[];for(var _i8=0;_i8<maxSlides;_i8++){for(var e=0,max=$li[_i8].children.length;e<max;e++){if(!$li[_i8].children[e].classList.contains("fs-Frame")){$caption[_i8]=$li[_i8].children[e];$caption[_i8].classList.add("fs-Caption");$caption[_i8].style.transitionDuration=fadeTime+"ms";}}}}
var imgCount=0;var $img=[];for(var _i9=0;_i9<maxSlides;_i9++){$li[_i9].appendChild($frame[_i9]);$li[_i9].classList.add("fs-Item");$img[_i9]=new Image();$img[_i9].src=$li[_i9].getAttribute("data-src");$frame[_i9].appendChild($img[_i9]);if(colorFilter){$img[_i9].style.animationDuration=duration-fadeTime-1000+"ms";}
$img[_i9].onload=function(){totalImgSize.x+=this.naturalWidth;totalImgSize.y+=this.naturalHeight;imgCount++;if(imgCount==maxSlides)init();};$img[_i9].onerror=function(e){console.log(e);};}
function init(){Helper.sizing(totalImgSize.x,totalImgSize.y);if(maxSlides>1){startProps();createControls();if(animation){$frame[0].style.opacity="1";window.addEventListener("load",function(){setTimeout(function(){autoPlay();setTimeout(function(){$frame[0].style.opacity="";},1000);},2000);});}else{fade2();}
outPageListen();}else{$frame[0].style.opacity=1;}
window.addEventListener("resize",function(){Helper.sliderResize();});};function outPageListen(){document.addEventListener("visibilitychange",function(){if(document.visibilityState=="hidden"){if(animation){stopAutoPlay();for(var _i10=0;_i10<maxSlides;_i10++){$frame[_i10].classList.remove("-fadeIn");$frame[_i10].classList.remove("-animated");$frame[_i10].classList.remove("-fadeOut");$frame[_i10].style.animationName="";$frame[_i10].style.animationDuration="";$frame[_i10].style.transitionDuration="";if(colorFilter)$img[_i10].classList.remove("-color");if(pager)$pagerLi[_i10].classList.remove("-active");}}else{stopAutoplay2();for(var _i11=0;_i11<maxSlides;_i11++){$frame[_i11].classList.remove("-fadeIn");$frame[_i11].classList.remove("-fadeOut");$frame[_i11].classList.remove("-active");$frame[_i11].style.transitionDuration="";if(pager)$pagerLi[_i11].classList.remove("-active");}}}
if(document.visibilityState=="visible"){if(animation){for(var _i12=0;_i12<maxSlides;_i12++){$frame[_i12].style.animationDuration=duration+fadeTime+"ms";$frame[_i12].style.transitionDuration=fadeTime+"ms";}}else{for(var _i13=0;_i13<maxSlides;_i13++){$frame[_i13].style.transitionDuration=fadeTime+"ms";}}
Helper.raf(function(){startProps();animation?autoPlay():fade2();});}});}
function startProps(){slidesCount=0;currentSlide=0;oldSlide=maxSlides-1;startState=true;if(caption)captionFade();}
function createControls(){if(controls){$leftControl=document.createElement("a");$leftControl.className="fs-Controls fs-LeftControl";$slider.insertBefore($leftControl,$viewport);$rightControl=document.createElement("a");$rightControl.className="fs-Controls fs-RightControl";$slider.appendChild($rightControl);}
if(pager){$pager=document.createElement("ul");$pager.classList.add("fs-Pager");$slider.appendChild($pager);for(var _i14=0;_i14<maxSlides;_i14++){$pager.appendChild(document.createElement("li"));}
$pagerLi=$pager.children;}
activeClick();}
function activeClick(){if(controls){$leftControl.addEventListener("click",leftControlHandler,false);$rightControl.addEventListener("click",rightControlHandler,false);}
if(pager){$pager.addEventListener("click",pagerHandler,false);}}
function stopClick(){if(controls){$leftControl.removeEventListener("click",leftControlHandler,false);$rightControl.removeEventListener("click",rightControlHandler,false);}
if(pager){$pager.removeEventListener("click",pagerHandler,false);}}
function stopAutoPlay(){clearTimeout(timeOut.fadeIn);clearTimeout(timeOut.autoPlay);}
function updatePager(){$pagerLi[currentSlide].classList.add("-active");$pagerLi[oldSlide].classList.remove("-active");}
function leftControlHandler(e){e.preventDefault();animation?stopAutoPlay():stopAutoplay2();oldSlide=currentSlide;currentSlide--;currentSlide=currentSlide<0?maxSlides-1:currentSlide--;if(pager)updatePager();action();}
function rightControlHandler(e){e.preventDefault();animation?stopAutoPlay():stopAutoplay2();oldSlide=currentSlide;currentSlide=currentSlide+1==maxSlides?0:currentSlide+1;if(pager)updatePager();action();}
function pagerHandler(e){if(e.target.tagName=="LI"){var index=[].indexOf.call($pagerLi,e.target);if(currentSlide!=index){animation?stopAutoPlay():stopAutoplay2();oldSlide=currentSlide;currentSlide=index;action();}}}
function action(){if(animation){startState=true;fade();autoPlay();}else{fade2();}}
function autoPlay(){if(pager)updatePager();if(startState==true){$frame[currentSlide].addEventListener("animationstart",listenAnimStart,false);startAnimation();startState=false;}
function listenAnimStart(){$frame[currentSlide].removeEventListener("animationstart",listenAnimStart,false);timeOut.fadeIn=setTimeout(function(){oldSlide=currentSlide;currentSlide=currentSlide+1==maxSlides?0:currentSlide+1;fade(listenAnimStart);},duration-fadeTime/2);timeOut.autoPlay=setTimeout(function(){autoPlay();},duration);}}
function startAnimation(){$frame[currentSlide].style.animationName=Helper.getMode();$frame[currentSlide].classList.add("-animated");slidesCount++;}
function captionFade(){$caption[currentSlide].style.display="block";Helper.raf(function(){$caption[currentSlide].classList.add("-active");});$caption[oldSlide].classList.remove("-active");$caption[oldSlide].addEventListener("transitionend",endCaption);function endCaption(){$caption[oldSlide].removeEventListener("transitionend",endCaption);$caption[oldSlide].style.display="";}}
function fade(startAnim){stopClick();$frame[currentSlide].classList.add("-fadeIn");$frame[oldSlide].classList.add("-fadeOut");if(caption)captionFade();$frame[currentSlide].addEventListener("transitionend",endFade,false);if(startState==false){$frame[currentSlide].addEventListener("animationstart",startAnim,false);startAnimation();}
function endFade(){$frame[currentSlide].removeEventListener("transitionend",endFade,false);$frame[currentSlide].classList.remove("-fadeIn");$frame[oldSlide].classList.remove("-animated");$frame[oldSlide].classList.remove("-fadeOut");$frame[oldSlide].style.animationName="";if(colorFilter==true){Helper.raf(function(){$img[oldSlide].classList.remove("-color");setTimeout(function(){$img[currentSlide].classList.add("-color");},fadeTime/4);});}
activeClick();}}
function fade2(){if(pager)updatePager();if(startState==true){$frame[currentSlide].style.transitionProperty="none";Helper.raf(function(){startFade();});}else{stopClick();startFade();}
function startFade(){$frame[currentSlide].classList.add("-active");if(caption)captionFade();if(startState==true){Helper.raf(function(){$frame[currentSlide].style.transitionProperty="";startState=false;});}else{$frame[oldSlide].classList.remove("-active");$frame[currentSlide].classList.add("-fadeIn");$frame[oldSlide].classList.add("-fadeOut");$frame[currentSlide].addEventListener("transitionend",endFade,false);}
if(auto){timeOut.autoPlay2=setTimeout(function(){oldSlide=currentSlide;currentSlide=currentSlide+1==maxSlides?0:currentSlide+1;fade2();},duration);}}
function endFade(){$frame[currentSlide].removeEventListener("transitionend",endFade,false);$frame[currentSlide].classList.remove("-fadeIn");$frame[oldSlide].classList.remove("-fadeOut");activeClick();}}
function stopAutoplay2(){clearTimeout(timeOut.autoPlay2);}};